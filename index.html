<!doctype html>
<html lang="it">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <!-- link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico" -->

  <title>Calcolo ferie</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
  <style type="text/css">
    td, td input {
      text-align: right;
    }
    td.bg-success, td.bg-danger, td.bg-primary {
      color: white;
    }
    td input {
      width: 100%;
    }
    td:nth-of-type(1n) {
      max-width: 30px;
    }
  </style>
</head>

<body class="bg-light">
  <div class="container" id="vue-app">
    <div class="row">
      <div class="col-md-12">
        <div class="table-responsive">
          <table class="table table-bordered">
            <tr>
              <th rowspan="2">&nbsp;</th>

              <th colspan="1">Anno 2021</th>
              <th colspan="2">Anno 2022</th>
              <th colspan="2">Anno 2023</th>
            </tr><tr>
              <th>Inizio anno</th>
              <!-- th>Fine nuovo</th -->
              <!-- th>Fine vecchio</th -->

              <th>Alg. nuovo</th>
              <th>Alg. vecchio</th>

              <th>Alg. nuovo</th>
              <th>Alg. vecchio</th>
            </tr><tr>
              <th>Ferie Ann<b>i</b> Precedenti</th>

              <td><input type="number" v-model="anni_prec_2021"></td>
              <!-- td>{{new_res_anni_prec_2021}}</td -->
              <!-- td>{{old_res_anni_prec_2021}}</td -->

              <td>{{new_anni_prec_2022}}</td>
              <td>{{old_anni_prec_2022}}</td>

              <td>{{new_anni_prec_2023}}</td>
              <td>{{old_anni_prec_2023}}</td>
            </tr><tr>
              <th>Ferie Ann<b>o</b> Precedente</th>

              <td><input type="number" v-model="anno_prec_2021"></td>
              <!-- td>{{new_res_anno_prec_2021}}</td -->
              <!-- td>{{old_res_anno_prec_2021}}</td -->

              <td>{{new_anno_prec_2022}}</td>
              <td>{{old_anno_prec_2022}}</td>

              <td>{{new_anno_prec_2023}}</td>
              <td>{{old_anno_prec_2023}}</td>
            </tr><tr>
              <th>Ferie Anno corrente</th>

              <td>{{anno_corr_2021}}</td>
              <!-- td>{{new_res_anno_corr_2021}}</td -->
              <!-- td>{{old_res_anno_corr_2021}}</td -->

              <td>{{new_anno_corr_2022}}</td>
              <td>{{old_anno_corr_2022}}</td>

              <td>{{new_anno_corr_2023}}</td>
              <td>{{old_anno_corr_2023}}</td>
            </tr><tr>
              <th>Ferie Minime da richiedere</th>

              <td>{{min_2021}}</td>
              <!-- td>{{new_res_anno_corr_2021}}</td -->
              <!-- td>{{old_res_anno_corr_2021}}</td -->

              <td :class="classe(new_min_2022, old_min_2022)">{{new_min_2022}}</td>
              <td :class="classe(old_min_2022, new_min_2022)">{{old_min_2022}}</td>

              <td :class="classe(new_min_2023, old_min_2023)">{{new_min_2023}}</td>
              <td :class="classe(old_min_2023, new_min_2023)">{{old_min_2023}}</td>
            </tr><tr>
              <th>Ferie primo semestre</th>

              <td>&nbsp;</td>
              <!-- td>{{new_res_anno_corr_2021}}</td -->
              <!-- td>{{old_res_anno_corr_2021}}</td -->

              <td :class="classe(new_primo_sem_2022, new_secondo_sem_2022)">{{new_primo_sem_2022}}</td>
              <td :class="classe(old_primo_sem_2022, old_secondo_sem_2022)">{{old_primo_sem_2022}}</td>

              <td :class="classe(new_primo_sem_2023, new_secondo_sem_2023)">{{new_primo_sem_2023}}</td>
              <td :class="classe(old_primo_sem_2023, old_secondo_sem_2023)">{{old_primo_sem_2023}}</td>
            </tr><tr>
              <th>Ferie secondo semestre</th>

              <td>&nbsp;</td>
              <!-- td>{{new_res_anno_corr_2021}}</td -->
              <!-- td>{{old_res_anno_corr_2021}}</td -->

              <td :class="classe(new_secondo_sem_2022, new_primo_sem_2022)">{{new_secondo_sem_2022}}</td>
              <td :class="classe(old_secondo_sem_2022, old_primo_sem_2022)">{{old_secondo_sem_2022}}</td>

              <td :class="classe(new_secondo_sem_2023, new_primo_sem_2023)">{{new_secondo_sem_2023}}</td>
              <td :class="classe(old_secondo_sem_2023, old_primo_sem_2023)">{{old_secondo_sem_2023}}</td>
            </tr><tr>
              <th>Ferie Richieste</th>

              <td colspan="1"><input type="number" v-model="richieste_2021"></td>
              <td colspan="2"><input type="number" v-model="richieste_2022"></td>
              <td colspan="2">&nbsp;</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">

      </div>
      <div class="col-md-6">

      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
  <script>
    var app = new Vue({
      el: '#vue-app',
      data: {
        anni_prec_2021: 5,
        anno_prec_2021: 10,
        anno_corr_2021: 28,

        richieste_2021: 28,
        richieste_2022: 28,

        new_res_anni_prec_2021: 0,
        new_res_anno_prec_2021: 0,
        new_res_anno_corr_2021: 0,
        old_res_anni_prec_2021: 0,
        old_res_anno_prec_2021: 0,
        old_res_anno_corr_2021: 0,

        new_anni_prec_2022: 0,
        new_anno_prec_2022: 0,
        new_anno_corr_2022: 28,
        old_anni_prec_2022: 0,
        old_anno_prec_2022: 0,
        old_anno_corr_2022: 28,

        new_res_anni_prec_2022: 0,
        new_res_anno_prec_2022: 0,
        new_res_anno_corr_2022: 0,
        old_res_anni_prec_2022: 0,
        old_res_anno_prec_2022: 0,
        old_res_anno_corr_2022: 0,

        new_anni_prec_2023: 0,
        new_anno_prec_2023: 0,
        new_anno_corr_2023: 28,
        old_anni_prec_2023: 0,
        old_anno_prec_2023: 0,
        old_anno_corr_2023: 28,

        min_2021: 0,
        new_min_2022: 0,
        old_min_2022: 0,
        new_min_2023: 0,
        old_min_2023: 0,
      },
      methods: {
        calcola_an: function() {
          this.new_res_anni_prec_2021 = 1 * this.anni_prec_2021;
          this.new_res_anno_prec_2021 = 1 * this.anno_prec_2021;
          this.new_res_anno_corr_2021 = 1 * this.anno_corr_2021;
          for (var i = 0; i < this.richieste_2021; i += 1){
            if (this.new_res_anni_prec_2021 > 0) this.new_res_anni_prec_2021 -= 1;
            else if (this.new_res_anno_corr_2021 > 0) this.new_res_anno_corr_2021 -= 1;
            else if (this.new_res_anno_prec_2021 > 0) this.new_res_anno_prec_2021 -= 1;
            else this.new_res_anno_corr_2021 -= 1;
          }
          this.new_anni_prec_2022 = this.new_res_anni_prec_2021 +
                                    this.new_res_anno_prec_2021;
          this.new_anno_prec_2022 = 1 * this.new_res_anno_corr_2021;

          this.new_res_anni_prec_2022 = 1 * this.new_anni_prec_2022;
          this.new_res_anno_prec_2022 = 1 * this.new_anno_prec_2022;
          this.new_res_anno_corr_2022 = 1 * this.new_anno_corr_2022;
          for (var i = 0; i < this.richieste_2022; i += 1){
            if (this.new_res_anni_prec_2022 > 0) this.new_res_anni_prec_2022 -= 1;
            else if (this.new_res_anno_corr_2022 > 0) this.new_res_anno_corr_2022 -= 1;
            else if (this.new_res_anno_prec_2022 > 0) this.new_res_anno_prec_2022 -= 1;
            else this.new_res_anno_corr_2022 -= 1;
          }
          this.new_anni_prec_2023 = this.new_res_anni_prec_2022 +
                                    this.new_res_anno_prec_2022;
          this.new_anno_prec_2023 = this.new_res_anno_corr_2022;

          this.min_2021 = 10 + 1 * this.anni_prec_2021;
          this.new_min_2022 = 10 + this.new_anni_prec_2022;
          this.new_min_2023 = 10 + this.new_anni_prec_2023;

          this.new_primo_sem_2022   = this.new_anni_prec_2022 + this.new_anno_prec_2022 + 28;
          this.new_primo_sem_2023   = this.new_anni_prec_2023 + this.new_anno_prec_2023 + 28;
          this.new_secondo_sem_2022 = this.new_anno_prec_2022 + 28;
          this.new_secondo_sem_2023 = this.new_anno_prec_2023 + 28;
        },
        calcola_av: function() {
          this.old_res_anni_prec_2021 = 1 * this.anni_prec_2021;
          this.old_res_anno_prec_2021 = 1 * this.anno_prec_2021;
          this.old_res_anno_corr_2021 = 1 * this.anno_corr_2021;
          for (var i = 0; i < this.richieste_2021; i += 1){
            if (this.old_res_anni_prec_2021 > 0) this.old_res_anni_prec_2021 -= 1;
            else if (this.old_res_anno_corr_2021 > 18) this.old_res_anno_corr_2021 -= 1;
            else if (this.old_res_anno_prec_2021 > 0) this.old_res_anno_prec_2021 -= 1;
            else this.old_res_anno_corr_2021 -= 1;
          }
          this.old_anni_prec_2022 = this.old_res_anni_prec_2021 +
                                    this.old_res_anno_prec_2021;
          this.old_anno_prec_2022 = 1 * this.old_res_anno_corr_2021;

          this.old_res_anni_prec_2022 = 1 * this.old_anni_prec_2022;
          this.old_res_anno_prec_2022 = 1 * this.old_anno_prec_2022;
          this.old_res_anno_corr_2022 = 1 * this.old_anno_corr_2022;
          for (var i = 0; i < this.richieste_2022; i += 1){
            if (this.old_res_anni_prec_2022 > 0) this.old_res_anni_prec_2022 -= 1;
            else if (this.old_res_anno_corr_2022 > 18) this.old_res_anno_corr_2022 -= 1;
            else if (this.old_res_anno_prec_2022 > 0) this.old_res_anno_prec_2022 -= 1;
            else this.old_res_anno_corr_2022 -= 1;
          }
          this.old_anni_prec_2023 = this.old_res_anni_prec_2022 + this.old_res_anno_prec_2022;
          this.old_anno_prec_2023 = this.old_res_anno_corr_2022;

          this.old_min_2022 = 10 + this.old_anni_prec_2022;
          this.old_min_2023 = 10 + this.old_anni_prec_2023;

          this.old_primo_sem_2022   = this.old_anni_prec_2022 + this.old_anno_prec_2022 + 28;
          this.old_primo_sem_2023   = this.old_anni_prec_2023 + this.old_anno_prec_2023 + 28;
          this.old_secondo_sem_2022 = this.old_anno_prec_2022 + 28;
          this.old_secondo_sem_2023 = this.old_anno_prec_2023 + 28;
        },
        ricalcola: function(){
          this.calcola_an();
          this.calcola_av();
        },
        classe: function(a,b){
          if (a > b) return 'bg-success';
          if (b > a) return 'bg-danger';
          return 'bg-primary';
        }
      },
      created: function () {
        this.ricalcola();
      },
      watch: {
        anni_prec_2021: function(){ this.ricalcola(); },
        anno_prec_2021: function(){ this.ricalcola(); },
        anno_corr_2021: function(){ this.ricalcola(); },
        richieste_2021: function(){ this.ricalcola(); },
        richieste_2022: function(){ this.ricalcola(); },
      }
    });
  </script>
</body>
</html>
